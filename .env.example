# ======================================================
# Fazumi â€” Phase 5 (Production-hardened defaults)
# ======================================================

# ----------------------
# Safety default
# ----------------------
# Keep true until you personally verify:
# - real WhatsApp summaries are sent
# - paywall works
# - usage increments only after successful send
DRY_RUN=true

# ----------------------
# Runtime / hosting
# ----------------------
# NOTE:
# - PORT is for the WEBHOOK SERVICE only (src/server.js).
# - WORKER POOL (src/worker.js) must NOT depend on PORT.
PORT=8080

# Process timezone (Linux/Node)
TZ=Asia/Qatar

# Fazumi timezone for all date grounding rules
FAZUMI_TZ=Asia/Qatar

# ----------------------
# Supabase (REQUIRED: service + worker)
# ----------------------
SUPABASE_URL=https://REPLACE_ME.supabase.co
SUPABASE_SERVICE_ROLE_KEY=REPLACE_ME

# ----------------------
# WhatsApp (360dialog) (REQUIRED: service + worker)
# ----------------------
# Official base URL is typically waba-v2.360dialog.io for production.
D360_BASE_URL=https://waba-v2.360dialog.io
D360_API_KEY=REPLACE_ME

# ----------------------
# 24-hour customer service window + templates (future proactive use)
# ----------------------
WHATSAPP_WINDOW_HOURS=24
HELLO_TEMPLATE_NAME=hello_fazumi
D360_TEMPLATE_LANG=en

# ----------------------
# OpenAI (WORKER ONLY)
# ----------------------
OPENAI_API_KEY=REPLACE_ME
OPENAI_PROJECT_ID=proj_REPLACE_ME
OPENAI_MODEL=gpt-4o-mini
OPENAI_TEMPERATURE=0.2

OPENAI_MAX_INPUT_CHARS=6000
OPENAI_MAX_OUTPUT_TOKENS=450
OPENAI_CONCURRENCY=1
OPENAI_MAX_RETRIES=4

# WhatsApp output cap (prompt/worker should respect this)
WHATSAPP_MAX_OUTPUT_CHARS=1800

# ----------------------
# Encryption for text minimization (SERVICE encrypts; WORKER decrypts)
# ----------------------
# base64 of exactly 32 random bytes (AES-256-GCM key)
FAZUMI_TEXT_ENC_KEY_B64=REPLACE_ME

# ----------------------
# Legal links (shown in first-time notice)
# ----------------------
TERMS_LINK=https://REPLACE_ME
PRIVACY_LINK=https://REPLACE_ME

# ----------------------
# Lemon Squeezy (SERVICE webhook + worker paywall messages)
# ----------------------
LEMON_CHECKOUT_URL=https://REPLACE_ME
LEMON_SIGNING_SECRET=REPLACE_ME

# ----------------------
# ZIP Chat Export (R3/R4)
# ----------------------
ZIP_MAX_BYTES=6000000
ZIP_MAX_TEXT_CHARS=1200000
ZIP_ONLY_CHAT_ANALYSIS=true
CHAT_EXPORTS_BUCKET=fazumi-chat-exports

# ----------------------
# Debug / ops (safe defaults)
# ----------------------
DEBUG_WEBHOOKS=0
DEBUG_META_KEYS=0
DEBUG_WEBHOOKS_SAMPLE_KEYS_ONLY=1
